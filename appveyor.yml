branches:
  only:
    - master

image: Visual Studio 2015
configuration: Debug
platform: x86

install:
 - appveyor DownloadFile http://slproweb.com/download/Win32OpenSSL_Light-1_1_0h.exe
 - Win32OpenSSL_Light-1_1_0h.exe /S
 - puhsd C:\OpenSSL-Win32
 - appveyor DownloadFile ftp://sources.redhat.com/pub/pthreads-win32/dll-latest/dll/x86/pthreadVC2.dll
 - popd
 - SET PATH=%PATH%;C:\OpenSSL-Win32
 - appveyor DownloadFile https://mosquitto.org/files/binary/win32/mosquitto-1.3.5-install-win32.exe
 - mosquitto-1.3.5-install-win32.exe /S
 - netstat -an
 - wmic service get state,displayname

build:
  project: builds\msvc\MqttCalcul.sln

after_build:
 - builds\msvc\Debug\unittest.exe
